var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(a){if(a){for(var b=ba,c=["Array","prototype","fill"],d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&aa(b,c,{configurable:!0,writable:!0,value:a})}}
ca(function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}});
var h=function(){var a=document.documentElement.style,b=void 0!==a.WebkitTransform&&"-webkit-"||void 0!==a.MozTransform&&"-moz-"||void 0!==a.msTransform&&"-ms-"||"";return{translate:function(a,d,e,f,g,k){return b+"transform:translate3d("+a+"px,"+d+"px,"+e+"px)rotateX("+f+"deg)rotateY("+g+"deg)rotateZ("+k+"deg);"},origin:function(a,d,e){return b+"transform-origin:"+a+"px "+d+"px "+e+"px;"},s:function(a){return"background:"+a+";"}}}(),n=[];function p(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0}
function da(){this.i=null;this.a=new p(0,0,0);this.b=new p(0,0,0)}da.prototype={};function ea(a){a.i&&(a.i.node.style.cssText=h.origin(-a.a.x,-a.a.y,-a.a.z)+h.translate(a.a.x,a.a.y,700,a.b.x,a.b.y,a.b.z),n.forEach(function(b){b.node.style.cssText=h.translate(b.x,b.y,-b.z,270,90+180*-Math.atan2(-a.a.y-b.y,-a.a.x-b.x)/Math.PI,180)+"width:"+b.width+"px;height:"+b.height+"px;"}))}
function q(a,b,c,d,e,f,g,k,N){"div"==a?(this.node=document.createElement("div"),this.node.className="plane wall"):"ceil"==a?(this.node=document.createElement("div"),this.node.className="plane ceil"):"floor"==a?(this.node=document.createElement("div"),this.node.className="plane floor"):"background"==a?(this.node=document.createElement("canvas"),this.node.className="plane background",this.node.height=c/4,this.node.width=b/4):"glitch"==a?(this.node=document.createElement("canvas"),this.node.className=
"plane glitch"):"data"==a&&(this.node=document.createElement("canvas"),this.node.className="plane data");this.width=b;this.height=c;this.a=new p(d,e,f);this.b=new p(g,k,N);this.g=function(){this.node.style.cssText+="width:"+this.width+"px;height:"+this.height+"px;"+h.translate(this.a.x,this.a.y,this.a.z,this.b.x,this.b.y,this.b.z)};this.g()}
function fa(a){this.node=document.createElement("div");this.node.className="world";a.node.appendChild(this.node);a.c.i=this;this.f=function(a){this.node.appendChild(a.node)};this.a=function(){this.node.innerHTML=""}}function ha(){var a=document.body;this.node=document.createElement("div");this.node.className="viewport";this.c=new da;a.appendChild(this.node)}
var r=[Math.random(),Math.random(),Math.random(),Math.random(),Math.random(),Math.random(),Math.random(),Math.random()],t=[-20,20,60,100,140,180,220,260],u=[],v,w,x,y=0;
function ia(){x=document.getElementsByClassName("background");.3>Math.random()&&(r.push(Math.random()),t.push(-20));for(var a=0;a<x.length;a++){var b=x[a];u[a]=b.getContext("2d");u[a].font="10px monospace";v=b.width;w=b.height;u[a].clearRect(0,0,v,w);for(b=0;b<r.length;b++)for(var c=0;7>c;c++)u[a].fillStyle="rgba(0,255,0,0."+(7-c)+")",u[a].fillText(Math.floor(9*Math.random()),r[b]*v,t[b]-10*c)}for(b=0;b<r.length;b++)t[b]+=4,t[b]>w+160&&(t.splice(b,1),r.splice(b,1),b--);setTimeout(ia,100)}
function ja(){for(var a=document.getElementsByClassName("glitch"),b=["6,7,96","222,236,6","235,236,237","6,24,114","12,11,11"],c=0;c<a.length;c++){var d=a[c],e=d.getContext("2d"),f=d.width;d=d.height;e.clearRect(0,0,f,d);e.beginPath();e.fillStyle="darkGreen";a[c].classList.contains("targeting")&&(e.fillStyle="red");e.rect(f/4,d/4,f/2,d/2);e.fill();for(var g=0;5>g;g++){e.beginPath();e.fillStyle="rgba("+b[Math.floor(Math.random()*b.length)]+","+parseInt(a[c].classList[0],10)/100+")";var k=Math.random()*
f,N=Math.random()*d,l=Math.random()*f,m=Math.random()*d;e.rect(Math.min(k,l),Math.min(N,m),Math.abs(k-l),Math.abs(N-m));e.fill()}}setTimeout(ja,150)}
function ka(){var a=document.getElementsByClassName("data");y+=10;200<y&&(y=10);for(var b=0;b<a.length;b++){var c=a[b],d=c.getContext("2d"),e=c.width,f=c.height;d.clearRect(0,0,e,f);c.width=200;c.height=500;d.font="20px monospace";d.fillStyle="white";d.fillText("Protect me",-y,f/2);d.fillText("Protect me",e-y,f/2);for(c=0;100>c;c++)d.fillText(Math.floor(9*Math.random()),e*Math.random(),f-(f/2-50)*Math.random());for(c=0;100>c;c++)d.fillText(Math.floor(9*Math.random()),e*Math.random(),(f/2-50)*Math.random())}setTimeout(ka,
150)}
function la(){z=[];A=0;var a;a:{var b=decodeURIComponent(document.cookie).split(";");for(a=0;a<b.length;a++){for(var c=b[a];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf("save=")){a=c.substring(5,c.length);break a}}a=""}if(a.constructor===String&&0<a.length&&(a=JSON.parse(a),a.constructor===Array)){A=a[0];0<A&&(document.getElementById("continueButton").className="option");for(b=1;b<a.length;b++)z.push(a[b]);if(0<z.length){a="<h2>Scores</h2>";for(b=0;b<z.length;b++)a+="<li>"+z[b]+" ticks</li>";document.getElementById("stats").innerHTML=
a;document.getElementById("statButton").className="option"}else document.getElementById("statButton").className="option option-disabled"}}
function ma(a,b){this.x=a;this.y=b;this.a=this.z=100;this.speed=2;this.height=this.width=300;this.h=!1;this.b=new q("glitch",300,300,this.x,this.y,this.z,270,270,180);this.node=this.b.node;B.f(this.b);n.push(this);this.frame=function(a,b){var c=!0;var d=this.x;var g=this.y;d=0>d||0>g||d>=C.length*D||g>=C[0].length*D?0:C[Math.floor(d/D)][Math.floor(g/D)];this.a+=.01;100<this.a&&(this.a=100);if(this.j(a,b,0))a=Math.atan2(b-this.y,a-this.x),this.node.className=this.a+" plane glitch targeting";else{if(0==
d||5==d)c=!1;a=(270+[-1,45,270,135,180,0,0,295,90,225][d])*Math.PI/180;this.node.className=this.a+" plane glitch"}c&&(this.x+=this.speed*Math.cos(a),this.y+=this.speed*Math.sin(a));return 5==d?!0:!1};this.j=function(a,b,e){return(this.x-a)*(this.x-a)+(this.y-b)*(this.y-b)<e*e};this.delete=function(){this.node.remove();for(var a=0;a<n.length;a++)n[a]===this&&n.splice(a,1)};this.g=function(){this.a-=1.5;0>=this.a&&(this.h=!0)};this.l=function(){var a=E,b=F,e=G,f=a+100*Math.sin(.0174532925*e);e=b+100*
Math.cos(.0174532925*e);var g=this.x,k=this.y;console.log(a+" "+b+" "+f+" "+e);a=Math.abs((e-b)*g-(f-a)*k+f*b-e*a)/Math.sqrt((e-b)*(e-b)+(f-a)*(f-a));console.log(a);100>a&&this.g()}}var H=0,I=0,J=0,K=270,G=0,E=1E3,F=1E3,na=150,L,C,D,M,O=[],z=[],A=0,P=0,Q=[20,100,300],R=0,S=87,T=83,U=65,V=68,oa=0;
function pa(){qa(0);this.a=!1;this.o=function(){qa(1);this.a=!0;J=0};this.frame=function(){J++;document.getElementById("frameAlive").innerHTML=Math.floor(J/100);this.a?(W[T]?-10<H&&(H-=.2):W[S]?10>H&&(H+=.2):.4>Math.abs(H)?H=0:H/=1.1,W[U]?-10<I&&(I-=.2):W[V]?10>I&&(I+=.2):.4>Math.abs(I)?I=0:I/=1.1):(I=3,G-=.12);var a=Math.sin(.0174532925*G),b=Math.cos(.0174532925*G),c=E,d=F;E+=a*H;F+=b*H;na+=0;F-=a*I;E+=b*I;X(E,F)||(X(c,F)?E=c:X(E,d)?F=d:X(c,d)?(E=c,F=d):console.log("error !"));0<R&&R--;if(ra)P++;
else{for(a=Q.length-1;0<=a;a--)if(P>Q[a]){this.m(a);break}P=0}b=!1;for(a=0;a<M.length;a++)M[a].frame(E,F)&&(b=!0,M[a].h=!0),0<R?M[a].l():M[a].j(E,F,100)&&(console.log("dead"),M[a].h=!0);for(a=M.length-1;0<=a;a--)M[a].h&&(M[a].delete(),M.splice(a,1));b&&this.g();1==J%1E4&&this.a&&O&&0<O.length&&(a=O[Math.floor(O.length*Math.random())],M.push(new ma(a.x,a.y)))};this.m=function(a){switch(a){case 0:console.log("basic attack");break;case 1:console.log("middle attack");break;case 2:console.log("strong attack"),
R=180}};this.g=function(){console.log("data corrupted !")};this.b=function(a,b){K+=a;G+=b;230>K&&(K=230);320<K&&(K=320)}}var W={};window.onkeydown=function(a){a=a||window.event;W[a.keyCode]=!0};window.onkeyup=function(a){a=a||window.event;delete W[a.keyCode]};var ra=0;function sa(a,b,c,d){var e=B;e.f(new q(d,c,500,a+c,b,-447,270,90,180));e.f(new q(d,c,500,a+c,b+c,-447,270,0,180));e.f(new q(d,c,500,a,b,-447,270,180,180));e.f(new q(d,c,500,a,b+c,-447,270,270,180))}var B;
function ta(){oa++;oa%=3;switch(oa){case 1:S=83;T=90;U=81;V=68;document.getElementById("keyboardType").innerHTML="azerty";break;case 0:S=87;T=83;U=65;V=68;document.getElementById("keyboardType").innerHTML="qwerty";break;case 2:S=38,T=40,U=37,V=39,document.getElementById("keyboardType").innerHTML="arrows"}}
window.onload=function(){function a(b){if(1E3<b-f)window.requestAnimationFrame(a),f=b;else{g+=b-f;for(f=b;16<=g;)d.frame(),c.c.a.x=-E,c.c.a.y=-F,c.c.a.z=na,c.c.b.x=K,c.c.b.y=0,c.c.b.z=G,ea(c.c),g-=16;var e=document.getElementById("attackLoader");b=e.getContext("2d");var l=e.offsetWidth,m=e.offsetHeight,k=l/m;b.clearRect(0,0,l,m);1>k?(e.width=800,e.height=800/k,l=800,m=800/k):(e.width=800*k,e.height=800,l=800*k,m=800);b.strokeStyle="rgba(255,255,255,0.4)";b.lineWidth=3;b.beginPath();b.arc(l/2,m/2,
5,0,2*Math.PI);b.stroke();b.strokeStyle="rgba(255,255,255,1)";0<P&&(e=P/Q[0],b.lineWidth=3,b.beginPath(),b.arc(l/2,m/2,5,0,2*Math.PI*e),b.stroke());P>Q[0]&&(b.lineWidth=4,b.beginPath(),b.arc(l/2,m/2,5,0,2*Math.PI),b.stroke(),b.strokeStyle="rgba(255,255,255,0.7)",e=(P-Q[0])/(Q[1]-Q[0]),b.lineWidth=3,b.beginPath(),b.arc(l/2,m/2,10,0,2*Math.PI*e),b.stroke());P>Q[1]&&(b.lineWidth=4,b.beginPath(),b.arc(l/2,m/2,10,0,2*Math.PI),b.stroke(),b.strokeStyle="rgba(255,255,255,0.7)",e=(P-Q[1])/(Q[2]-Q[1]),b.lineWidth=
3,b.beginPath(),b.arc(l/2,m/2,15,0,2*Math.PI*e),b.stroke());P>Q[2]&&(b.lineWidth=4,b.beginPath(),b.arc(l/2,m/2,15,0,2*Math.PI),b.stroke());window.requestAnimationFrame(a)}}function b(a){d.b(.5*-a.movementY,a.movementX/2)}document.body.onmousedown=function(){++ra};document.body.onmouseup=function(){--ra};la();var c=new ha;B=new fa(c);var d=new pa;c.c.a.x=0;c.c.a.y=0;c.c.a.z=150;c.c.b.x=270;c.c.b.y=0;c.c.b.z=0;ea(c.c);document.getElementById("keyboardButton").onclick=ta;document.getElementById("statButton").onclick=
function(){document.getElementById("stats").className="stats"};var e=document.getElementsByTagName("BODY")[0];e.requestPointerLock=e.requestPointerLock;document.getElementById("survivalButton").onclick=function(){e.onclick=function(){e.requestPointerLock()};e.requestPointerLock();document.getElementById("ingame").className="";d.o();document.getElementById("menu").classList.add("hidden")};document.addEventListener("pointerlockchange",function(){document.pointerLockElement===e?document.addEventListener("mousemove",
b,!1):document.removeEventListener("mousemove",b,!1)},!1);var f=0,g=0;a(0);ia();ja();ka()};
function qa(a){O=[];D=400;0==a?(L=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,1,0,1,0,0,0],[0,0,0,0,2,0,0,0,0],[0,0,0,1,0,1,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],F=E=700,G=45):1==a?(L=[[3,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[3,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0],[3,0,0,0,0,0,1,2,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0],[3,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[3,0,0,0,0,0,0,0,0,0,0,0]],E=1800,F=4200,G=180):2==a&&
(L=[[0,0,0,0,2],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[3,0,0,0,0]],F=E=1800,G=180);M=[];ua();a=L;var b=D;B.a();var c=a.length*b,d=a[0].length*b;B.f(new q("floor",c,d,0,d,53,180,0,0));B.f(new q("ceil",c,d,0,0,-447,0,0,0));for(var e=0;e<a.length;e++)for(var f=0;f<a[e].length;f++)1==a[e][f]&&sa(e*b,f*b,b,"div"),2==a[e][f]&&sa(e*b+b/4,f*b+b/4,b/2,"data"),3==a[e][f]&&O.push({x:e*b+b/2,y:f*b+b/2});B.f(new q("background",d,500,0,0,-447,270,90,180));B.f(new q("background",c,500,c,0,-447,270,0,180));B.f(new q("background",
c,500,0,d,-447,270,180,180));B.f(new q("background",d,500,c,d,-447,270,270,180))}
function ua(){C=[];for(var a=[],b=0;b<L.length;b++){C.push([]);for(var c=0;c<L[0].length;c++)2==L[b][c]&&a.push([b,c,5,0]),C[b].push(-1)}for(;0<a.length;){a.sort(function(a,b){return a[3]-b[3]});b=a[0];a.splice(0,1);c=b[0];var d=b[1],e=b[3];0<=c&&c<L.length&&0<=d&&d<L[0].length&&(1==L[c][d]?C[c][d]=0:-1==C[c][d]&&(a.push([c+1,d,2,e+2]),a.push([c-1,d,8,e+2]),a.push([c,d+1,6,e+2]),a.push([c,d-1,4,e+2]),Y(c+1,d)&&Y(c,d+1)&&a.push([c+1,d+1,7,e+3]),Y(c-1,d)&&Y(c,d-1)&&a.push([c-1,d-1,3,e+3]),Y(c-1,d)&&
Y(c,d+1)&&a.push([c-1,d+1,1,e+3]),Y(c+1,d)&&Y(c,d-1)&&a.push([c+1,d-1,9,e+3]),C[c][d]=b[2]))}console.log(C)}function Y(a,b){return 0>a||0>b||a>=L.length||b>=L[0].length?!1:1!=L[a][b]}function Z(a,b){return 0>a||0>b||a>=L.length*D||b>=L[0].length*D?!1:1!=L[Math.floor(a/D)][Math.floor(b/D)]}function X(a,b){return Z(a-80,b-80)&&Z(a+80,b-80)&&Z(a-80,b+80)&&Z(a+80,b+80)};
